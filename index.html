<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Meetup RSVP</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/@babel/standalone@7.23.6/babel.min.js"></script>

    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.344.0",
        "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
      }
    }
    </script>

    <script>
        window.__firebase_config = JSON.stringify({
            apiKey: "YOUR_API_KEY_HERE",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        });
        window.__app_id = 'english-meetup-default';
    </script>
</head>
<body class="bg-slate-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel" data-type="module" data-presets="react">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { initializeApp } from 'firebase/app';
        import { getAuth, signInAnonymously, onAuthStateChanged } from 'firebase/auth';
        import { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc, deleteDoc, serverTimestamp, setDoc, writeBatch } from 'firebase/firestore';
        import { Users, MapPin, Calendar, CheckCircle, Clock, MessageCircle, Info, Smile, Banknote, Copy, ExternalLink, AlertCircle, Phone, Lock, Trash2, Hourglass, ThumbsUp, HelpCircle, Shield, LogOut, ArrowRightLeft, BookOpen, ChevronDown, ChevronUp, Upload, Settings, Save, XCircle, Award, Activity, User, MessageSquare, Download, RefreshCw, AlertTriangle } from 'lucide-react';

        // Firebase Init
        const firebaseConfigRaw = window.__firebase_config;
        let firebaseConfig = {};
        try { firebaseConfig = JSON.parse(firebaseConfigRaw); } catch (e) {}
        
        let app, auth, db;
        try {
            if (firebaseConfig.apiKey && firebaseConfig.apiKey !== "YOUR_API_KEY_HERE") {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
            }
        } catch (err) { console.error("Firebase Init Error:", err); }

        const appId = window.__app_id || 'default-app-id';
        const ATTENDEES_COLLECTION = 'english_meetup_attendees';
        const CONFIG_COLLECTION = 'english_meetup_config'; 
        const CONFIG_DOC_ID = 'meetup_info'; 

        function EnglishMeetupRSVP() {
          const [user, setUser] = useState(null);
          const [attendees, setAttendees] = useState([]);
          
          // --- [ìˆ˜ì • ì™„ë£Œ] ì›ë³¸ í…ìŠ¤íŠ¸ 100% ë³µêµ¬ ---
          const [meetupInfo, setMeetupInfo] = useState({
            // 1. Header Info
            clubName: "Jett's English Crew",
            meetupTitle: "ì„±ë¶ ì¤‘ìƒê¸‰ ì˜ì–´íšŒí™” & í† ë¡ ",
            meetupDesc: "ì¼ìƒ íšŒí™”ë¥¼ ììœ ë¡­ê²Œ êµ¬ì‚¬í•˜ëŠ” ê²ƒì„ ë„˜ì–´ì„œ ë” ê¹Šì´ ìˆëŠ” ì˜ì–´ í† ë¡ ì„ ì—°ìŠµí•˜ëŠ” ì¤‘ìƒê¸‰ ëª¨ì„ì…ë‹ˆë‹¤.",
            
            // 2. Basic Info
            date: "2026ë…„ 2ì›” 1ì¼ (ì¼)",
            time: "ì˜¤ì „ 10:00 - 12:00",
            locationName: "íƒì•¤íƒìŠ¤ ì„±ì‹ ì—¬ëŒ€ì ",
            locationAddress: "ì„œìš¸ ì„±ë¶êµ¬ ë™ì†Œë¬¸ë¡œ22ê¸¸ 31",
            locationLink: "https://map.naver.com/v5/search/íƒì•¤íƒìŠ¤%20ì„±ì‹ ì—¬ëŒ€ì ",

            // --- Curriculum Part 1 ---
            part1Title: "Part 1. Warm-up & Session 1",
            part1Duration: "50 min",
            p1Time1: "20'", p1Title1: "Small Talk", p1Desc1: "ê°€ë²¼ìš´ ì£¼ì œë¡œ ììœ ë¡­ê²Œ ëŒ€í™” (Ice-breaking)",
            p1Time2: "30'", p1Title2: "Reading & Discussion 1", p1Desc2: "ì‹¬í™” ì§€ë¬¸ ë…í•´ ë° ì‹¬ì¸µ í† ë¡ ",
            p1Time3: "", p1Title3: "", p1Desc3: "",

            // --- Intermission ---
            breakTitle: "Break (10 min)",
            breakDesc: "Seat Change: íŒŒíŠ¸ë„ˆ êµì²´",

            // --- Curriculum Part 2 ---
            part2Title: "Part 2. Session 2 & Wrap-up",
            part2Duration: "50 min",
            p2Time1: "10'", p2Title1: "Refresh Talk", p2Desc1: "ìƒˆ íŒŒíŠ¸ë„ˆì™€ ì¸ì‚¬ ë° ê°€ë²¼ìš´ ìŠ¤ëª°í†¡",
            p2Time2: "30'", p2Title2: "Reading & Discussion 2", p2Desc2: "ë‘ ë²ˆì§¸ ì§€ë¬¸ ë…í•´ ë° ì˜ê²¬ êµí™˜",
            p2Time3: "10'", p2Title3: "Closing", p2Desc3: "ì†Œê° ê³µìœ  ë° ë§ˆë¬´ë¦¬",

            // Topic
            topicTitle: "Travel & Adventure",
            session2Topic: "Travel Styles",
            session2Question: "Do you prefer planning every detail of a trip or being spontaneous? What are the pros and cons?",

            // Settings
            maxCapacity: 8,
            fee: "1,000",
            originalFee: "3,000", 
            drinkPolicy: "â˜• ê°œì¸ ìŒë£ŒëŠ” ë³„ë„ë¡œ ì£¼ë¬¸í•´ì£¼ì„¸ìš” (1ì¸ 1ë©”ë‰´)", 
            bankName: "ì¹´ì¹´ì˜¤ë±…í¬",
            bankAccount: "3333-26-2044919",
            accountHolder: "í™ê¸¸ë™",

            // Leader Info (ì›ë³¸ í…ìŠ¤íŠ¸ ë³µêµ¬)
            leaderName: "Jett",
            leaderImage: "https://api.dicebear.com/9.x/avataaars/svg?seed=Jett&backgroundColor=c0aede", 
            leaderBio: "ë°˜ê°‘ìŠµë‹ˆë‹¤! ë¦¬ë” Jettì…ë‹ˆë‹¤. ğŸ‘‹\nì € ë˜í•œ ì—¬ëŸ¬ë¶„ê³¼ í•¨ê»˜ ì„±ì¥í•´ê°€ëŠ” ì¤‘~ì¤‘ìƒê¸‰ ì˜ì–´ í•™ìŠµìì…ë‹ˆë‹¤. í˜¸ì£¼ ì›Œí™€ê³¼ TESOL ê³¼ì •ì„ ê±°ì³¤ì§€ë§Œ, ì—¬ì „íˆ ì˜ì–´ë¥¼ ì“°ê³  ë°°ìš°ëŠ” ê³¼ì • ìì²´ê°€ ì¦ê±°ìš´ ì—°ìŠµìƒì´ì£ .\n\n'ì™„ë²½í•¨'ë³´ë‹¤ëŠ” 'ì†Œí†µì˜ ì¦ê±°ì›€'ì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤. 3ë…„ê°„ ëª¨ì„ì„ ì´ëŒì–´ì˜¨ ê²½í—˜ìœ¼ë¡œ í¸ì•ˆí•œ ë¶„ìœ„ê¸°ë¥¼ ë§Œë“¤ì–´ ë“œë¦´ê²Œìš”. ë¶€ë‹´ ì—†ì´ ì˜¤ì…”ì„œ í•¨ê»˜ ë– ë“¤ì–´ìš”! ğŸŒâœ¨",
            leaderTags: "TESOL ìˆ˜ë£Œ, í˜¸ì£¼ ì›Œí‚¹í™€ë¦¬ë°ì´, ì„¸ê³„ì¼ì£¼, ì»¬ì»´ ë¦¬ë” 3ë…„+, í•„ë¦¬í•€ ì–´í•™ì—°ìˆ˜, TOEFL/IELTS ê²½í—˜",

            // Etiquette (ì›ë³¸ í…ìŠ¤íŠ¸ ë³µêµ¬)
            etiquetteTitle: "í´ëŸ½ ê·œì¹™",
            etiquette1Title: "ğŸ‘‚ ì„œë¡œë¥¼ ì¡´ì¤‘í•˜ê³  ê²½ì²­í•´ìš”",
            etiquette1Desc: "íƒ€ì¸ì˜ ë°œì–¸ ì¤‘ì—ëŠ” í•¸ë“œí° ì‚¬ìš©ì„ ìì œí•˜ê³  ê·€ ê¸°ìš¸ì—¬ì£¼ì„¸ìš”. ë¬´ë¡€í•œ ì–¸í–‰ì´ë‚˜ ê³¼ë„í•œ ì‚¬ìƒí™œ ì§ˆë¬¸ì€ No!",
            etiquette2Title: "â³ ë°œì–¸ê¶Œì€ ê³µí‰í•˜ê²Œ",
            etiquette2Desc: "í•œ ì‚¬ëŒì´ ëŒ€í™”ë¥¼ ë…ì í•˜ì§€ ì•Šë„ë¡ ë°°ë ¤í•´ì£¼ì„¸ìš”. (í•œ í„´ì— 2~3ë¶„ ì´ë‚´ë¡œ ë§í•˜ê¸°)",
            etiquette3Title: "ğŸš« ìˆœìˆ˜í•œ í•™ìŠµ ëª¨ì„ì…ë‹ˆë‹¤",
            etiquette3Desc: "ì¢…êµ í™œë™, ì˜ì—…, ì´ì„± êµì œ ëª©ì ì˜ ì°¸ì—¬ëŠ” ì—„ê²©íˆ ê¸ˆì§€í•˜ë©° ê°•í‡´ ì‚¬ìœ ê°€ ë©ë‹ˆë‹¤.",

            // FAQ & Contact (ì›ë³¸ í…ìŠ¤íŠ¸ ë³µêµ¬)
            openChatLink: "https://open.kakao.com/o/sExample", 
            faq1Q: "ì£¼ì°¨ ê°€ëŠ¥í•œê°€ìš”?",
            faq1A: "íƒì•¤íƒìŠ¤ ê±´ë¬¼ ë‚´ ì£¼ì°¨ëŠ” ì–´ë µìŠµë‹ˆë‹¤. ì¸ê·¼ ê³µì˜ì£¼ì°¨ì¥ì„ ì´ìš©í•˜ì‹œê±°ë‚˜ ëŒ€ì¤‘êµí†µ ì´ìš©ì„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.",
            faq2Q: "ì˜ì–´ë¥¼ ì˜ ëª»í•´ë„ ë˜ë‚˜ìš”?",
            faq2A: "ë¬¼ë¡ ì…ë‹ˆë‹¤! ì¤‘ìƒê¸‰ ì§€í–¥ì´ì§€ë§Œ, í‹€ë¦¬ëŠ” ê²ƒì„ ë‘ë ¤ì›Œí•˜ì§€ ì•Šê³  ì¦ê²ê²Œ ì†Œí†µí•˜ë ¤ëŠ” ë§ˆìŒë§Œ ìˆë‹¤ë©´ ì¶©ë¶„í•©ë‹ˆë‹¤.",
            faq3Q: "ì¤€ë¹„ë¬¼ì´ ìˆë‚˜ìš”?",
            faq3A: "ê°€ë²¼ìš´ ë§ˆìŒìœ¼ë¡œ ì˜¤ì‹œë©´ ë©ë‹ˆë‹¤. í•„ìš”í•œ í•™ìŠµ ìë£ŒëŠ” ë¦¬ë”ê°€ ì¤€ë¹„í•´ ë“œë¦½ë‹ˆë‹¤. ê°œì¸ í•„ê¸°êµ¬ ì •ë„ë§Œ ì±™ê²¨ì£¼ì„¸ìš”."
          });

          // Form States
          const [name, setName] = useState('');
          const [nickname, setNickname] = useState('');
          const [contact, setContact] = useState('');
          const [password, setPassword] = useState('');
          const [gender, setGender] = useState('female'); 
          const [englishLevel, setEnglishLevel] = useState('mid'); 
          const [transferred, setTransferred] = useState(false);
          const [rememberMe, setRememberMe] = useState(false);
          
          // UI States
          const [isAdmin, setIsAdmin] = useState(false);
          const [showAdminLogin, setShowAdminLogin] = useState(false);
          const [adminPinInput, setAdminPinInput] = useState('');
          const [loading, setLoading] = useState(false);
          const [errorMsg, setErrorMsg] = useState('');
          const [copied, setCopied] = useState(false);
          const [dDay, setDDay] = useState('');
          
          // Toggle States
          const [showCurriculum, setShowCurriculum] = useState(false);
          const [isLeaderExpanded, setIsLeaderExpanded] = useState(false);
          const [activeFaq, setActiveFaq] = useState(null);
          const [activeEtiquette, setActiveEtiquette] = useState(null);

          // Modal & Logic States
          const [isEditingInfo, setIsEditingInfo] = useState(false);
          const [editForm, setEditForm] = useState({});
          const [expandedSections, setExpandedSections] = useState({header:true});
          const [isCancelMode, setIsCancelMode] = useState(false);
          const [showPasswordModal, setShowPasswordModal] = useState(false);
          const [cancelPasswordInput, setCancelPasswordInput] = useState('');
          const [targetDeleteId, setTargetDeleteId] = useState(null);
          const [toast, setToast] = useState(null); 
          const [modalConfig, setModalConfig] = useState(null);
          
          const ADMIN_PIN = 'wpxm123'; 

          // --- Effects ---
          useEffect(() => {
            if (!auth) return;
            signInAnonymously(auth).catch(console.error);
            onAuthStateChanged(auth, setUser);
            const saved = localStorage.getItem('meetup_user_info');
            if(saved) {
                try {
                    const p = JSON.parse(saved);
                    setName(p.name||''); setNickname(p.nickname||''); setContact(p.contact||''); 
                    setPassword(p.password||''); setGender(p.gender||'female'); setEnglishLevel(p.englishLevel||'mid'); 
                    setRememberMe(true);
                } catch(e){}
            }
          }, []);

          useEffect(() => {
            if (!user || !db) return;
            onSnapshot(collection(db, 'artifacts', appId, 'public', 'data', ATTENDEES_COLLECTION), (s) => {
                const d = s.docs.map(doc => ({id: doc.id, ...doc.data()})).sort((a,b) => (b.createdAt?.seconds||0)-(a.createdAt?.seconds||0));
                setAttendees(d);
            });
            onSnapshot(doc(db, 'artifacts', appId, 'public', 'data', CONFIG_COLLECTION, CONFIG_DOC_ID), (s) => {
                if(s.exists()) setMeetupInfo(prev => ({...prev, ...s.data()}));
            });
          }, [user]);

          useEffect(() => {
            if (!meetupInfo.date) return;
            try {
                const yearMatch = meetupInfo.date.match(/(\d{4})ë…„/);
                const monthMatch = meetupInfo.date.match(/(\d{1,2})ì›”/);
                const dayMatch = meetupInfo.date.match(/(\d{1,2})ì¼/);
                if (yearMatch && monthMatch && dayMatch) {
                    const targetDate = new Date(parseInt(yearMatch[1]), parseInt(monthMatch[1]) - 1, parseInt(dayMatch[1]));
                    const today = new Date(); targetDate.setHours(0,0,0,0); today.setHours(0,0,0,0);
                    const diffDays = Math.ceil((targetDate - today) / (1000 * 60 * 60 * 24));
                    if (diffDays === 0) setDDay("D-Day"); else if (diffDays > 0) setDDay(`D-${diffDays}`); else setDDay("End");
                }
            } catch(e) {}
          }, [meetupInfo.date]);

          // --- Helper Functions ---
          const showToast = (msg, type='success') => { setToast({message: msg, type}); setTimeout(() => setToast(null), 3000); };
          const handleCopyAccount = () => {
            navigator.clipboard.writeText(meetupInfo.bankAccount);
            setCopied(true); setTimeout(() => setCopied(false), 2000); showToast('ê³„ì¢Œë²ˆí˜¸ ë³µì‚¬ë¨');
          };
          const handleCopyTopic = () => {
             const txt = `[${meetupInfo.topicTitle}]\n\n${meetupInfo.session2Topic}\n"${meetupInfo.session2Question}"`;
             navigator.clipboard.writeText(txt); showToast("í† í”½ ë³µì‚¬ë¨");
          };
          const handleImageUpload = (e) => {
            const file = e.target.files[0];
            if (!file) return;
            if (file.size > 500 * 1024) return showToast("ì´ë¯¸ì§€ 500KB ì´í•˜ë§Œ ê°€ëŠ¥", "error");
            const reader = new FileReader();
            reader.onloadend = () => setEditForm(prev => ({ ...prev, leaderImage: reader.result }));
            reader.readAsDataURL(file);
          };

          // --- Logic ---
          const approvedList = attendees.filter(a => a.status === 'approved');
          const effectiveCount = approvedList.length + attendees.filter(a => a.status === 'pending' && a.paid).length;
          const currentMaxCapacity = parseInt(meetupInfo.maxCapacity) || 8;
          const isFull = effectiveCount >= currentMaxCapacity;

          const handleApply = async (e) => {
            e.preventDefault();
            if (!auth) return showToast("DB ì—°ê²° ì‹¤íŒ¨", 'error');
            if (!name.trim()) return setErrorMsg('ì´ë¦„ í•„ìˆ˜');
            if (!isFull && !transferred) return setErrorMsg('ì†¡ê¸ˆ ì²´í¬ í•„ìˆ˜');
            if (isFull && !contact.trim()) return setErrorMsg('ì—°ë½ì²˜ í•„ìˆ˜');
            if (!password || password.length < 4) return setErrorMsg('ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬ í•„ìˆ˜');

            setLoading(true);
            try {
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', ATTENDEES_COLLECTION), {
                    name: name.trim(), nickname: nickname.trim(), contact: contact.trim(), password: password.trim(),
                    gender, englishLevel, status: 'pending', isWaitlistApply: isFull, paid: !isFull,
                    createdAt: serverTimestamp(), userId: user.uid
                });
                if(rememberMe) localStorage.setItem('meetup_user_info', JSON.stringify({name, nickname, contact, password, gender, englishLevel}));
                else localStorage.removeItem('meetup_user_info');
                setName(''); setNickname(''); setContact(''); setPassword(''); setErrorMsg('');
                showToast(isFull ? 'ëŒ€ê¸° ì‹ ì²­ ì™„ë£Œ' : 'ì‹ ì²­ ì™„ë£Œ');
            } catch(e) { console.error(e); showToast('ì˜¤ë¥˜ ë°œìƒ', 'error'); }
            setLoading(false);
          };

          const handleDeleteRequest = (id) => { 
              if(isAdmin) {
                  setModalConfig({title: 'ì‚­ì œ', message: 'ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?', onConfirm: async() => {
                      await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', ATTENDEES_COLLECTION, id));
                      setModalConfig(null); showToast('ì‚­ì œë¨');
                  }});
              } else {
                  setTargetDeleteId(id); setShowPasswordModal(true); 
              }
          };
          
          const verifyCancelPassword = async () => {
             const target = attendees.find(a => a.id === targetDeleteId);
             if(target && target.password === cancelPasswordInput) {
                 await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', ATTENDEES_COLLECTION, targetDeleteId));
                 showToast('ì·¨ì†Œ ì™„ë£Œ'); setShowPasswordModal(false); setCancelPasswordInput('');
             } else {
                 showToast('ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜', 'error');
             }
          };

          const handleApprove = async (id) => {
              if(approvedList.length >= currentMaxCapacity) if(!confirm('ì •ì› ì´ˆê³¼ì…ë‹ˆë‹¤. ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
              await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', ATTENDEES_COLLECTION, id), {status: 'approved', paid: true});
              showToast('ìŠ¹ì¸ ì™„ë£Œ');
          };

          const saveInfo = async () => {
            await setDoc(doc(db, 'artifacts', appId, 'public', 'data', CONFIG_COLLECTION, CONFIG_DOC_ID), editForm);
            setIsEditingInfo(false); showToast('ì €ì¥ ì™„ë£Œ');
          };

          const openEditModal = () => { setEditForm({...meetupInfo}); setIsEditingInfo(true); };
          const toggleEditSection = (key) => setExpandedSections(prev => ({...prev, [key]: !prev[key]}));

          const downloadCSV = () => {
             if(attendees.length===0) return showToast('ë°ì´í„° ì—†ìŒ','error');
             const headers = ['ì´ë¦„','ë‹‰ë„¤ì„','ì—°ë½ì²˜','ì„±ë³„','ë ˆë²¨','ìƒíƒœ','ì…ê¸ˆì—¬ë¶€','ì‹ ì²­ì‹œê°„'];
             const rows = attendees.map(a => [a.name, a.nickname, a.contact, a.gender, a.englishLevel, a.status, a.paid?'Y':'N', new Date(a.createdAt?.seconds*1000).toLocaleString()]);
             const csv = '\uFEFF' + [headers, ...rows].map(e => e.join(',')).join('\n');
             const link = document.createElement('a'); link.href = URL.createObjectURL(new Blob([csv],{type:'text/csv'}));
             link.download = `attendees_${new Date().toISOString().slice(0,10)}.csv`; link.click();
          };

          const handleReset = () => {
             setModalConfig({title:'ì´ˆê¸°í™”', message:'ëª¨ë“  ì°¸ê°€ì ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?', isDestructive:true, onConfirm: async() => {
                 const batch = writeBatch(db);
                 attendees.forEach(a => batch.delete(doc(db, 'artifacts', appId, 'public', 'data', ATTENDEES_COLLECTION, a.id)));
                 await batch.commit(); setModalConfig(null); showToast('ì´ˆê¸°í™” ì™„ë£Œ');
             }});
          };

          const EditSectionHeader = ({title, sectionKey}) => (
             <button onClick={()=>toggleEditSection(sectionKey)} className="w-full flex justify-between p-3 bg-slate-50 border-b font-bold text-slate-700">
                <span>{title}</span> {expandedSections[sectionKey]?<ChevronUp size={18}/>:<ChevronDown size={18}/>}
             </button>
          );

          // --- Render ---
          return (
            <div className="min-h-screen bg-slate-50 font-sans text-slate-800 pb-20 relative">
              <header className="bg-indigo-600 text-white p-6 shadow-lg">
                <div className="max-w-3xl mx-auto flex justify-between items-start">
                    <div>
                        <h1 className="text-3xl font-bold mb-2">{meetupInfo.clubName}</h1>
                        <p className="opacity-90 font-medium text-lg flex items-center gap-2">
                            {dDay && <span className={`text-xs font-extrabold px-2 py-1 rounded shadow-sm ${dDay==='End'?'bg-slate-200 text-slate-500':'bg-white text-red-600'}`}>{dDay}</span>}
                            {meetupInfo.meetupTitle}
                        </p>
                        <p className="text-indigo-100 text-sm mt-2 leading-relaxed">{meetupInfo.meetupDesc}</p>
                    </div>
                    {isAdmin && <button onClick={openEditModal} className="bg-white/10 p-2 rounded hover:bg-white/20"><Settings size={20}/></button>}
                </div>
              </header>

              <main className="max-w-3xl mx-auto p-4 space-y-6 -mt-6">
                <div className="grid md:grid-cols-2 gap-4">
                  <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100 flex items-start gap-4">
                    <div className="bg-indigo-100 p-3 rounded-full text-indigo-600 shrink-0"><Calendar size={24} /></div>
                    <div><h3 className="font-semibold text-slate-500 text-sm uppercase">Date & Time</h3><p className="font-bold text-lg">{meetupInfo.date}</p><p className="text-indigo-600 font-medium">{meetupInfo.time}</p></div>
                  </div>
                  <div className="bg-white p-5 rounded-xl shadow-sm border border-slate-100 flex items-start gap-4">
                    <div className="bg-emerald-100 p-3 rounded-full text-emerald-600 shrink-0"><MapPin size={24} /></div>
                    <div className="flex-1"><h3 className="font-semibold text-slate-500 text-sm uppercase">Location</h3><p className="font-bold text-lg">{meetupInfo.locationName}</p><p className="text-slate-500 text-sm mb-2">{meetupInfo.locationAddress}</p><a href={meetupInfo.locationLink} target="_blank" className="inline-flex items-center gap-1 text-xs font-bold bg-emerald-50 text-emerald-600 px-2 py-1 rounded hover:bg-emerald-100"><ExternalLink size={12}/> ì§€ë„ ë³´ê¸°</a></div>
                  </div>
                </div>

                {meetupInfo.leaderName && (
                  <div className="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                    <div className="bg-gradient-to-r from-indigo-50 to-white p-4 flex items-center gap-2 border-b border-indigo-50"><Award size={20} className="text-indigo-600"/><h2 className="font-bold text-lg text-indigo-900">Meet Your Host</h2></div>
                    <div className="p-6 flex flex-col md:flex-row gap-6 items-start">
                         <div className="shrink-0 flex flex-col items-center justify-center w-full md:w-48 bg-slate-50 rounded-xl p-4 border border-slate-100">
                            <img src={meetupInfo.leaderImage} className="w-24 h-24 md:w-full md:h-auto md:aspect-square rounded-full md:rounded-xl border-4 border-white shadow-md mb-3 object-cover" onError={(e)=>e.target.src="https://api.dicebear.com/9.x/avataaars/svg?seed=Fallback"}/>
                            <div className="text-center w-full"><p className="font-bold text-xl text-slate-800">{meetupInfo.leaderName}</p><p className="text-xs text-indigo-600 font-bold bg-indigo-100 px-2 py-0.5 rounded-full inline-block mt-1 mb-3">English Meetup Leader</p><button onClick={() => setIsLeaderExpanded(!isLeaderExpanded)} className="w-full py-2 flex items-center justify-center gap-1 text-sm font-bold text-slate-500 bg-white border border-slate-200 rounded-lg md:hidden">{isLeaderExpanded ? 'ì ‘ê¸°' : 'ì†Œê°œ ë³´ê¸°'} {isLeaderExpanded ? <ChevronUp size={16}/> : <ChevronDown size={16}/>}</button></div>
                         </div>
                         <div className={`flex-1 flex flex-col justify-center space-y-5 ${isLeaderExpanded ? 'block' : 'hidden'} md:flex`}><div className="text-sm text-slate-600 leading-relaxed whitespace-pre-wrap">{meetupInfo.leaderBio}</div>{meetupInfo.leaderTags && (<div><h3 className="text-xs font-bold text-slate-400 uppercase mb-2 flex items-center gap-1"><Activity size={12}/> Background & Experience</h3><div className="flex flex-wrap gap-2">{meetupInfo.leaderTags.split(',').map((tag, idx) => (<span key={idx} className="bg-white text-slate-700 text-xs px-3 py-1.5 rounded-lg font-medium border border-slate-200 shadow-sm flex items-center gap-1.5"><CheckCircle size={12} className="text-indigo-400"/> {tag.trim()}</span>))}</div></div>)}</div>
                    </div>
                  </div>
                )}

                <div className="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                  <div className="bg-indigo-50 p-4 flex items-center gap-2 border-b border-indigo-100"><MessageCircle size={20} className="text-indigo-600"/><h2 className="font-bold text-lg text-indigo-900">This Week's Topic</h2><button onClick={handleCopyTopic} className="ml-auto text-xs bg-white text-indigo-600 border border-indigo-200 px-2 py-1 rounded flex items-center gap-1 hover:bg-indigo-50"><Copy size={12}/> í† í”½ ë³µì‚¬</button></div>
                  <div className="p-5">
                    <div className="bg-slate-50 p-4 rounded-lg border border-slate-200 mb-6"><h4 className="font-bold text-indigo-600 text-sm mb-2">Today's Debate Topic</h4><p className="text-slate-700 text-sm italic whitespace-pre-wrap">"{meetupInfo.session2Question}"</p></div>
                    <button onClick={() => setShowCurriculum(!showCurriculum)} className="w-full flex items-center justify-between p-3 bg-indigo-50 text-indigo-700 font-bold rounded-lg border border-indigo-100 mb-4"><span className="flex items-center gap-2"><BookOpen size={18}/> ìì„¸í•œ ì§„í–‰ ë°©ì‹ í™•ì¸í•˜ê¸°</span>{showCurriculum ? <ChevronUp size={20}/> : <ChevronDown size={20}/>}</button>
                    {showCurriculum && (<div className="animate-in fade-in slide-in-from-top-2 duration-300 space-y-6"><div><h3 className="font-bold text-indigo-800">{meetupInfo.part1Title} <span className="text-xs font-normal text-indigo-400">{meetupInfo.part1Duration}</span></h3><div className="mt-2 space-y-2"><div className="text-sm flex gap-2"><span className="font-bold w-10 text-indigo-600">{meetupInfo.p1Time1}</span> <span>{meetupInfo.p1Title1} - {meetupInfo.p1Desc1}</span></div><div className="text-sm flex gap-2"><span className="font-bold w-10 text-indigo-600">{meetupInfo.p1Time2}</span> <span>{meetupInfo.p1Title2} - {meetupInfo.p1Desc2}</span></div></div></div><div className="bg-amber-50 p-3 rounded text-amber-800 text-sm font-bold flex gap-2"><ArrowRightLeft size={16}/> {meetupInfo.breakTitle}: {meetupInfo.breakDesc}</div><div><h3 className="font-bold text-indigo-800">{meetupInfo.part2Title} <span className="text-xs font-normal text-indigo-400">{meetupInfo.part2Duration}</span></h3><div className="mt-2 space-y-2"><div className="text-sm flex gap-2"><span className="font-bold w-10 text-indigo-600">{meetupInfo.p2Time1}</span> <span>{meetupInfo.p2Title1} - {meetupInfo.p2Desc1}</span></div><div className="text-sm flex gap-2"><span className="font-bold w-10 text-indigo-600">{meetupInfo.p2Time2}</span> <span>{meetupInfo.p2Title2} - {meetupInfo.p2Desc2}</span></div><div className="text-sm flex gap-2"><span className="font-bold w-10 text-indigo-600">{meetupInfo.p2Time3}</span> <span>{meetupInfo.p2Title3} - {meetupInfo.p2Desc3}</span></div></div></div></div>)}
                  </div>
                </div>

                <div className={`bg-white p-6 rounded-xl shadow-md border-l-4 ${isFull ? 'border-orange-500' : 'border-indigo-500'}`}>
                   <h2 className="text-xl font-bold mb-4 flex items-center gap-2"><Banknote className={isFull?"text-orange-500":"text-indigo-500"}/>{isFull ? 'ëŒ€ê¸° ì‹ ì²­ (Join Waitlist)' : 'ì°¸ê°€ ì‹ ì²­ (Join Us)'}</h2>
                   <div className={`mb-6 p-4 rounded text-sm ${isFull?'bg-orange-50 text-orange-900':'bg-indigo-50 text-indigo-900'}`}>
                      {isFull ? (<><p className="font-bold flex items-center gap-1 mb-2 bg-white/50 p-2 rounded text-orange-600"><Clock size={16}/> í˜„ì¬ ì •ì› ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤. ëŒ€ê¸°ìë¡œ ì‹ ì²­ë©ë‹ˆë‹¤.</p><div className="flex items-start gap-2 mt-2"><AlertCircle size={16} className="shrink-0 mt-0.5"/><p>ëŒ€ê¸° ì‹ ì²­ì€ <strong>ë¬´ë£Œ</strong>ì…ë‹ˆë‹¤.<br/>ë¹ˆ ìë¦¬ê°€ ìƒê¸°ë©´ ì—°ë½ë“œë¦½ë‹ˆë‹¤.</p></div><p className="mt-2 font-bold text-orange-700">â€» ì˜ˆìƒ ì°¸ê°€ë¹„: {meetupInfo.fee}ì›</p></>) : (<><div className="font-bold text-lg flex items-center gap-2"><span>ğŸ’¡ ì°¸ê°€ë¹„:</span>{meetupInfo.originalFee && <span className="line-through text-slate-400 text-sm">{meetupInfo.originalFee}ì›</span>}<span className="text-red-600">{meetupInfo.fee}ì›</span></div><div className="flex flex-wrap gap-2 mt-2 items-center"><span>{meetupInfo.bankName} {meetupInfo.bankAccount} ({meetupInfo.accountHolder})</span><button onClick={handleCopyAccount} className="bg-white border px-2 py-1 rounded text-xs font-bold hover:bg-slate-50 flex items-center gap-1">{copied ? <CheckCircle size={12}/> : <Copy size={12}/>} {copied ? 'ë³µì‚¬ë¨' : 'ê³„ì¢Œ ë³µì‚¬'}</button></div><hr className="my-2 border-indigo-100"/><p className="text-xs opacity-70 flex items-center gap-1 font-medium">{meetupInfo.drinkPolicy}</p><p className="text-xs text-slate-600 font-medium">ğŸš« ë¶ˆì°¸ ì‹œ ì°¸ê°€ë¹„ëŠ” ë°˜í™˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p></>)}
                   </div>
                   <form onSubmit={handleApply} className="space-y-6">
                      <div><label className="block text-sm font-bold text-slate-700 mb-1.5 flex items-center gap-1.5"><User size={16} className="text-indigo-600"/> ì´ë¦„ (ì˜ˆê¸ˆì£¼)</label><input type="text" value={name} onChange={e=>setName(e.target.value)} placeholder="ex) í™ê¸¸ë™" className="w-full p-3 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500"/><p className="text-xs text-slate-500 mt-1.5 flex items-start gap-1"><AlertCircle size={12} className="shrink-0 mt-0.5 text-indigo-500"/> ì†¡ê¸ˆ í™•ì¸ í›„ ìŠ¹ì¸ì„ ìœ„í•´ ë°˜ë“œì‹œ <b>ì˜ˆê¸ˆì£¼ ëª…</b>ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.</p></div>
                      {isFull && (<div><label className="block text-sm font-bold text-slate-700 mb-1.5 flex items-center gap-1.5"><Phone size={16} className="text-indigo-600"/> ì—°ë½ì²˜ (Contact)</label><input type="tel" value={contact} onChange={e=>setContact(e.target.value)} placeholder="010-0000-0000" className="w-full p-3 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500"/><p className="text-xs text-orange-600 mt-1.5 flex items-start gap-1 font-medium"><Info size={12} className="shrink-0 mt-0.5"/> ë¹ˆ ìë¦¬ê°€ ìƒê¸°ë©´ ì´ ë²ˆí˜¸ë¡œ ì—°ë½ë“œë¦½ë‹ˆë‹¤.</p></div>)}
                      <div><label className="block text-sm font-bold text-slate-700 mb-1.5 flex items-center gap-1.5"><Smile size={16} className="text-indigo-600"/> ì˜ì–´ ì´ë¦„ (Nickname)</label><input type="text" value={nickname} onChange={e=>setNickname(e.target.value)} placeholder="ex) Gil" className="w-full p-3 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-indigo-500"/><p className="text-xs text-slate-500 mt-1.5 flex items-start gap-1"><Info size={12} className="shrink-0 mt-0.5 text-slate-400"/> ì°¸ê°€ í™•ì • ëª…ë‹¨ì—ëŠ” ì´ ì˜ì–´ ì´ë¦„ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</p></div>
                      <div><label className="block text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5"><Users size={16} className="text-indigo-600"/> ì„±ë³„ (Gender)</label><div className="flex gap-3">{['male', 'female'].map(g => (<label key={g} className={`flex-1 border rounded-lg p-3 flex justify-center items-center gap-2 cursor-pointer transition-all ${gender===g ? 'bg-indigo-50 border-indigo-500 text-indigo-700 ring-1 ring-indigo-500' : 'hover:bg-slate-50'}`}><input type="radio" name="gender" value={g} checked={gender===g} onChange={e=>setGender(e.target.value)} className="hidden"/>{g==='male'?'ğŸ‘¨ ë‚¨ì„±':'ğŸ‘© ì—¬ì„±'}</label>))}</div></div>
                      <div><label className="block text-sm font-bold text-slate-700 mb-2 flex items-center gap-1.5"><Activity size={16} className="text-indigo-600"/> ì˜ì–´ íšŒí™” ì‹¤ë ¥</label><div className="grid gap-2">{[{val: 'low-mid', title: 'ì¤‘í•˜ (Lower Intermediate)', desc: 'ë¬¸ì¥ êµ¬ì„±ì´ ì„œíˆ´ì§€ë§Œ ì˜ì‚¬ì†Œí†µ ê°€ëŠ¥', color: 'slate'},{val: 'mid', title: 'ì¤‘ (Intermediate)', desc: 'ì¼ìƒì ì¸ ì£¼ì œë¡œ ëŒ€í™” ê°€ëŠ¥', color: 'emerald'},{val: 'mid-high', title: 'ì¤‘ìƒ (Upper Intermediate)', desc: 'ë‹¤ì–‘í•œ ì£¼ì œë¡œ ì˜ê²¬ í‘œí˜„ ê°€ëŠ¥', color: 'blue'},{val: 'high', title: 'ìƒ (Advanced)', desc: 'ë§‰í˜ì—†ì´ ììœ ë¡œìš´ í† ë¡  ê°€ëŠ¥', color: 'purple'}].map(lvl => (<label key={lvl.val} className={`border rounded-lg p-3 flex items-center gap-3 cursor-pointer transition-all hover:bg-slate-50 ${englishLevel === lvl.val ? `bg-${lvl.color}-50 border-${lvl.color}-500 ring-1 ring-${lvl.color}-500` : ''}`}><input type="radio" name="englishLevel" value={lvl.val} checked={englishLevel === lvl.val} onChange={e => setEnglishLevel(e.target.value)} className={`w-4 h-4 accent-${lvl.color}-600 shrink-0`}/><div className="text-sm"><span className={`font-bold block text-${lvl.color}-900`}>{lvl.title}</span><span className={`text-xs text-${lvl.color}-700 opacity-80`}>{lvl.desc}</span></div></label>))}</div><p className="text-xs text-slate-500 mt-2 flex gap-1"><Info size={12} className="shrink-0 mt-0.5"/> ì„±ë³„ê³¼ ì˜ì–´ ì‹¤ë ¥ì€ íŒ€ ë¹Œë”©(ì¡° í¸ì„±) ì‹œ í™œìš©ë˜ëŠ” ì •ë³´ì…ë‹ˆë‹¤.</p></div>
                      <div><label className="block text-sm font-bold text-slate-700 mb-1.5 flex items-center gap-1.5"><Lock size={16} className="text-indigo-600"/> ë¹„ë°€ë²ˆí˜¸ (4ìë¦¬)</label><div className="flex gap-2 justify-center relative">{[0,1,2,3].map(i => (<div key={i} className={`w-12 h-12 border-2 rounded-lg flex items-center justify-center text-xl font-bold bg-white transition-all ${password.length===i ? 'border-indigo-500 ring-2 ring-indigo-200' : 'border-slate-200'}`}>{password[i] || ''}</div>))}<input type="tel" maxLength={4} value={password} onChange={e=>setPassword(e.target.value.replace(/[^0-9]/g,''))} className="absolute inset-0 opacity-0 cursor-pointer w-full h-full"/></div><p className="text-xs text-center text-slate-500 mt-2 flex justify-center items-center gap-1"><Info size={12}/> ì‹ ì²­ ì·¨ì†Œ ì‹œ ë³¸ì¸ í™•ì¸ì„ ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.</p></div>
                      <div className="space-y-4 flex flex-col">{!isFull && (<label className="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-slate-50"><input type="checkbox" checked={transferred} onChange={e=>setTransferred(e.target.checked)} className="w-5 h-5 text-indigo-600 rounded"/><span className="text-slate-700 font-medium">ì°¸ê°€ë¹„ ì†¡ê¸ˆì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.</span></label>)}<label className="flex items-center gap-3 p-3 border rounded-lg cursor-pointer hover:bg-slate-50"><input type="checkbox" checked={rememberMe} onChange={e=>setRememberMe(e.target.checked)} className="w-5 h-5 text-indigo-600 rounded"/><span className="text-slate-700 font-medium">ë‹¤ìŒ ë°©ë¬¸ ì‹œ ìë™ ì…ë ¥í•©ë‹ˆë‹¤. (ì„ íƒ)</span></label>{errorMsg && <p className="text-red-500 font-bold text-center animate-pulse text-sm">{errorMsg}</p>}<button type="submit" disabled={loading} className={`w-full py-3 rounded-lg text-white font-bold flex items-center justify-center gap-2 shadow-md transition-transform active:scale-95 ${isFull?'bg-orange-500 hover:bg-orange-600':'bg-indigo-600 hover:bg-indigo-700'}`}>{loading ? 'ì²˜ë¦¬ì¤‘...' : (<><Send size={18}/> {isFull ? 'ëŒ€ê¸°ìë¡œ ì‹ ì²­í•˜ê¸° (Join Waitlist)' : 'ì°¸ê°€ ì‹ ì²­í•˜ê¸° (Apply)'}</>)}</button></div>
                   </form>
                </div>

                <div className="bg-white rounded-xl shadow-sm border p-4">
                   <div className="flex justify-between items-center mb-4 flex-wrap gap-2"><h2 className="text-xl font-bold flex items-center gap-2"><Users className="text-emerald-600"/> ì°¸ê°€ì ëª…ë‹¨ ({effectiveCount}/{currentMaxCapacity})</h2><button onClick={()=>setIsCancelMode(!isCancelMode)} className={`text-xs border px-2 py-1 rounded transition-colors ${isCancelMode?'bg-slate-800 text-white':'text-slate-500 hover:bg-slate-50'}`}>{isCancelMode?'ì·¨ì†Œ ëª¨ë“œ ë„ê¸°':'ë‚´ ì‹ ì²­ ì·¨ì†Œí•˜ê¸°'}</button></div>
                   <p className="text-xs text-slate-500 mb-3 flex gap-1"><Info size={14} className="shrink-0 mt-0.5"/> ì°¸ê°€ ìŠ¹ì¸ì€ ì„±ë³„ ë° ì‹¤ë ¥ê³¼ ë¬´ê´€í•˜ê²Œ ì„ ì°©ìˆœìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.</p>
                   <div className="divide-y divide-slate-100">
                     {attendees.map(att => (<div key={att.id} className="py-4 flex justify-between items-center"><div className="flex items-center gap-3"><div className="w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center font-bold text-indigo-700 shrink-0">{(att.nickname || att.name)[0]}</div><div><div className="flex items-center gap-1"><p className="font-bold text-slate-800">{att.nickname || att.name}</p>{user && user.uid === att.userId && <span className="text-[10px] bg-indigo-100 text-indigo-700 font-bold px-1.5 py-0.5 rounded">ME</span>}{isAdmin && <span className="text-xs text-slate-400">({att.name})</span>}</div><div className="flex flex-col gap-1 mt-0.5">{isAdmin && (<div className="flex gap-1"><span className="text-[10px] border px-1 rounded">{att.gender==='male'?'ë‚¨':'ì—¬'}</span><span className="text-[10px] border px-1 rounded">{att.englishLevel}</span>{att.contact && <span className="text-[10px] bg-yellow-50 px-1 rounded">{att.contact}</span>}</div>)}<p className="text-xs text-slate-500">{att.status === 'approved' ? (<span className="flex items-center gap-1 text-emerald-600 font-bold bg-emerald-50 px-2 py-0.5 rounded w-fit"><CheckCircle size={12}/> í™•ì •</span>) : att.isWaitlistApply ? (<span className="flex items-center gap-1 text-orange-600 font-bold bg-orange-50 px-2 py-0.5 rounded w-fit"><Hourglass size={12}/> ëŒ€ê¸°</span>) : (<span className="flex items-center gap-1 text-amber-600 font-bold bg-amber-50 px-2 py-0.5 rounded w-fit"><Clock size={12}/> ëŒ€ê¸°ì¤‘</span>)}</p></div></div></div><div className="flex gap-2">{(isAdmin || isCancelMode) && (<button onClick={()=>handleDeleteRequest(att.id)} className="text-red-400 p-1.5 hover:bg-red-50 rounded transition-colors" title="ì‚­ì œ"><Trash2 size={20}/></button>)}{isAdmin && att.status !== 'approved' && (<button onClick={()=>handleApprove(att.id)} className="text-emerald-500 p-1.5 hover:bg-emerald-50 rounded transition-colors" title="ìŠ¹ì¸"><CheckCircle size={20}/></button>)}</div></div>))}
                     {attendees.length === 0 && <div className="text-center py-10 bg-white rounded-xl border border-dashed border-slate-300 text-slate-400">ì•„ì§ ì‹ ì²­ìê°€ ì—†ìŠµë‹ˆë‹¤.</div>}
                   </div>
                   {isAdmin && (
                       <div className="mt-6 pt-6 border-t flex flex-col gap-2">
                           <button onClick={downloadCSV} className="w-full py-2 bg-emerald-50 text-emerald-700 font-bold rounded flex justify-center gap-2 border border-emerald-200 transition-colors hover:bg-emerald-100"><Download size={16}/> ì—‘ì…€(CSV)ë¡œ ëª…ë‹¨ ì €ì¥ (Backup)</button>
                           <button onClick={handleReset} className="w-full py-2 bg-red-50 text-red-600 font-bold rounded flex justify-center gap-2 border border-red-200 transition-colors hover:bg-red-100"><RefreshCw size={16}/> ì°¸ê°€ì ëª…ë‹¨ ì´ˆê¸°í™” (Reset All)</button>
                       </div>
                   )}
                </div>

                <div className="bg-white rounded-xl shadow-sm border overflow-hidden"><div className="bg-indigo-50 p-4 border-b text-indigo-900 font-bold flex gap-2 items-center"><ThumbsUp size={20} className="text-indigo-600"/> {meetupInfo.etiquetteTitle}</div>{[1,2,3].map(i => (<div key={i} className="border-b last:border-0 group"><button onClick={()=>setActiveEtiquette(activeEtiquette===i?null:i)} className="w-full p-4 text-left hover:bg-slate-50 transition-colors flex justify-between items-center"><span className="font-bold text-slate-700 text-sm"><span className="text-indigo-500 mr-2">{i}.</span>{meetupInfo[`etiquette${i}Title`]}</span><ChevronDown size={16} className={`text-slate-400 transition-transform ${activeEtiquette===i?'rotate-180':''}`}/></button>{activeEtiquette===i && <div className="p-4 pt-0 pl-9 text-sm text-slate-600 bg-slate-50 leading-relaxed border-t border-slate-100">{meetupInfo[`etiquette${i}Desc`]}</div>}</div>))}</div>
                <div className="bg-white rounded-xl shadow-sm border overflow-hidden"><div className="bg-indigo-50 p-4 border-b text-indigo-900 font-bold flex gap-2 items-center"><HelpCircle size={20} className="text-indigo-600"/> ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)</div>{[1,2,3].map(i => (<div key={i} className="border-b last:border-0 group"><button onClick={()=>setActiveFaq(activeFaq===i?null:i)} className="w-full p-4 text-left hover:bg-slate-50 transition-colors flex justify-between items-center"><span className="font-bold text-slate-700 text-sm"><span className="text-indigo-500 mr-2">Q.</span>{meetupInfo[`faq${i}Q`]}</span><ChevronDown size={16} className={`text-slate-400 transition-transform ${activeFaq===i?'rotate-180':''}`}/></button>{activeFaq===i && <div className="p-4 pt-0 text-sm text-slate-600 bg-slate-50 leading-relaxed"><span className="font-bold text-emerald-600 mr-1">A.</span>{meetupInfo[`faq${i}A`]}</div>}</div>))}</div>
                <div className="bg-indigo-50 p-6 rounded-xl border border-indigo-100 text-center"><h3 className="font-bold text-indigo-900 mb-2">ê¶ê¸ˆí•œ ì ì´ ë” ìˆìœ¼ì‹ ê°€ìš”?</h3><p className="text-indigo-700/80 text-sm mb-4">ìš´ì˜ì§„ì—ê²Œ ì§ì ‘ ë¬¸ì˜í•˜ê±°ë‚˜ ì˜¤í”ˆì±„íŒ…ë°©ì—ì„œ ì†Œí†µí•´ë³´ì„¸ìš”!</p><a href={meetupInfo.openChatLink} target="_blank" className="inline-flex items-center gap-2 bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-3 px-6 rounded-lg shadow-sm transition-all active:scale-95"><MessageSquare size={18} /> ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°© ë°”ë¡œê°€ê¸°</a></div>
              </main>

              {toast && (<div className="fixed top-4 left-1/2 -translate-x-1/2 z-[100] animate-in fade-in slide-in-from-top-5 duration-300 w-full max-w-sm px-4"><div className={`shadow-lg rounded-lg p-4 flex items-center gap-3 text-white font-medium ${toast.type==='error'?'bg-red-500':'bg-emerald-500'}`}>{toast.type==='error' ? <AlertCircle size={20}/> : <CheckCircle size={20}/>}{toast.message}</div></div>)}
              {showPasswordModal && (<div className="fixed inset-0 bg-black/60 flex items-center justify-center z-[70] p-4 animate-in fade-in"><div className="bg-white p-6 rounded-xl w-full max-w-sm shadow-2xl"><div className="flex items-center gap-3 mb-4"><div className="p-3 rounded-full bg-slate-100 text-slate-600"><Lock size={24}/></div><h3 className="font-bold text-lg text-slate-900">ì‹ ì²­ ì·¨ì†Œ í™•ì¸</h3></div><p className="text-slate-600 mb-4 text-sm">ì‹ ì²­ ì‹œ ì„¤ì •í•œ ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p><div className="relative flex gap-3 justify-center mb-6">{[0,1,2,3].map(i=>(<div key={i} className={`w-12 h-12 border-2 rounded-lg flex items-center justify-center text-xl font-bold bg-white ${cancelPasswordInput.length===i?'border-indigo-500 bg-indigo-50 ring-2 ring-indigo-200':'border-slate-200'}`}>{cancelPasswordInput[i]||''}</div>))}<input type="tel" maxLength={4} value={cancelPasswordInput} onChange={e=>setCancelPasswordInput(e.target.value.replace(/[^0-9]/g,''))} className="absolute inset-0 opacity-0 cursor-pointer w-full h-full" autoFocus/></div><div className="flex gap-3"><button onClick={()=>setShowPasswordModal(false)} className="flex-1 py-2.5 bg-slate-100 font-bold rounded-lg hover:bg-slate-200">ë‹«ê¸°</button><button onClick={verifyCancelPassword} className="flex-1 py-2.5 bg-red-500 text-white font-bold rounded-lg hover:bg-red-600">ì·¨ì†Œí•˜ê¸°</button></div></div></div>)}
              {modalConfig && (<div className="fixed inset-0 bg-black/60 flex items-center justify-center z-[80] p-4 animate-in fade-in"><div className="bg-white p-6 rounded-xl w-full max-w-sm shadow-2xl"><div className="flex items-center gap-3 mb-4"><div className={`p-3 rounded-full ${modalConfig.isDestructive?'bg-red-100 text-red-600':'bg-amber-100 text-amber-600'}`}><AlertTriangle size={24}/></div><h3 className="font-bold text-lg text-slate-900">{modalConfig.title}</h3></div><p className="text-slate-600 mb-6">{modalConfig.message}</p><div className="flex gap-3"><button onClick={()=>setModalConfig(null)} className="flex-1 py-2.5 bg-slate-100 font-bold rounded-lg hover:bg-slate-200">ì·¨ì†Œ</button><button onClick={modalConfig.onConfirm} className={`flex-1 py-2.5 text-white font-bold rounded-lg ${modalConfig.isDestructive?'bg-red-500 hover:bg-red-600':'bg-indigo-600 hover:bg-indigo-700'}`}>í™•ì¸</button></div></div></div>)}
              {showAdminLogin && (<div className="fixed inset-0 bg-black/60 flex items-center justify-center z-[90] p-4"><div className="bg-white p-6 rounded-xl w-full max-w-sm shadow-2xl"><h3 className="font-bold mb-4 text-center">ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</h3><input type="password" value={adminPinInput} onChange={e=>setAdminPinInput(e.target.value)} className="border p-3 rounded-lg mb-4 w-full text-center tracking-widest text-lg outline-none focus:ring-2 ring-indigo-500" placeholder="PIN" autoFocus/><div className="flex gap-2"><button onClick={()=>setShowAdminLogin(false)} className="flex-1 py-2 bg-slate-100 rounded-lg font-bold">ì·¨ì†Œ</button><button onClick={()=>{if(adminPinInput===ADMIN_PIN){setIsAdmin(true); setShowAdminLogin(false); setAdminPinInput(''); showToast('ê´€ë¦¬ìë‹˜ í™˜ì˜í•©ë‹ˆë‹¤');}else{showToast('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤','error');}}} className="flex-1 py-2 bg-indigo-600 text-white rounded-lg font-bold">í™•ì¸</button></div></div></div>)}
              
              {/* --- Admin Edit Modal --- */}
              {isEditingInfo && (
                <div className="fixed inset-0 bg-black/60 z-[80] flex items-end sm:items-center justify-center p-0 sm:p-4 animate-in fade-in">
                  <div className="bg-white rounded-t-xl sm:rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]">
                    <div className="p-4 border-b bg-slate-50 flex justify-between items-center shrink-0"><h3 className="font-bold text-lg flex items-center gap-2"><Settings size={20} className="text-indigo-600"/> ëª¨ì„ ì •ë³´ ìˆ˜ì •</h3><button onClick={()=>setIsEditingInfo(false)}><XCircle size={24} className="text-slate-400 hover:text-slate-600"/></button></div>
                    <div className="overflow-y-auto">
                       {['header','basic','curriculum','topic','leader'].map(sec => (
                           <div key={sec} className="border-b">
                               <EditSectionHeader title={sec === 'header' ? '1. í—¤ë” ì„¤ì • (Header)' : sec === 'basic' ? '2. ê¸°ë³¸ ì •ë³´ (Date, Time)' : sec === 'curriculum' ? '3. ì»¤ë¦¬í˜ëŸ¼ (Curriculum)' : sec === 'topic' ? '4. ì£¼ì œ (Topic)' : '5. ë¦¬ë” ë° ê¸°íƒ€ (Leader)'} sectionKey={sec}/>
                               {expandedSections[sec] && <div className="p-4 space-y-3 bg-white">
                                   {Object.keys(meetupInfo).filter(k => {
                                       if(sec==='header') return ['clubName','meetupTitle','meetupDesc'].includes(k);
                                       if(sec==='basic') return ['date','time','locationName','locationAddress','locationLink','maxCapacity','fee','originalFee','bankName','bankAccount','accountHolder'].includes(k);
                                       if(sec==='curriculum') return k.startsWith('part') || k.startsWith('p1') || k.startsWith('p2') || k.startsWith('break');
                                       if(sec==='topic') return k.includes('topic') || k.includes('session2') || k.includes('Question');
                                       if(sec==='leader') return k.includes('leader') || k.includes('faq') || k.includes('etiquette') || k.includes('openChat');
                                       return false;
                                   }).map(k => (
                                       <div key={k}><label className="text-xs font-bold text-slate-500 mb-1 block">{k}</label>
                                       {k.includes('Desc') || k.includes('Bio') || k.includes('Question') || k.startsWith('faq') && k.endsWith('A') || k.startsWith('etiquette') && k.endsWith('Desc') ? <textarea className="w-full border p-2 rounded text-sm" rows={3} value={editForm[k]||''} onChange={e=>setEditForm({...editForm, [k]:e.target.value})}/> : <input type="text" className="w-full border p-2 rounded text-sm" value={editForm[k]||''} onChange={e=>setEditForm({...editForm, [k]:e.target.value})}/>}
                                       </div>
                                   ))}
                                   {sec==='leader' && <div><label className="text-xs font-bold text-slate-500 mb-1 block">ë¦¬ë” ì´ë¯¸ì§€ ì—…ë¡œë“œ</label><input type="file" accept="image/*" onChange={handleImageUpload} className="w-full text-xs"/></div>}
                               </div>}
                           </div>
                       ))}
                    </div>
                    <div className="p-4 border-t bg-slate-50 flex gap-2 shrink-0"><button onClick={()=>setIsEditingInfo(false)} className="flex-1 py-3 bg-white border rounded-lg font-bold hover:bg-slate-50">ì·¨ì†Œ</button><button onClick={saveInfo} className="flex-1 py-3 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 flex justify-center gap-2"><Save size={18}/> ì„¤ì • ì €ì¥</button></div>
                  </div>
                </div>
              )}

              <footer className="max-w-3xl mx-auto mt-12 px-4 flex justify-between items-center text-slate-400 text-sm pb-8">
                 <p>Â© 2026 {meetupInfo.clubName}</p>
                 <div>{!isAdmin ? (<button onClick={()=>setShowAdminLogin(true)} className="hover:text-slate-600 flex items-center gap-1"><Shield size={14}/> ê´€ë¦¬ì ë¡œê·¸ì¸</button>) : (<button onClick={()=>{setIsAdmin(false); showToast('ê´€ë¦¬ì ë¡œê·¸ì•„ì›ƒ');}} className="text-indigo-500 font-bold hover:text-indigo-700 flex items-center gap-1"><LogOut size={14}/> ë¡œê·¸ì•„ì›ƒ</button>)}</div>
              </footer>
            </div>
          );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<EnglishMeetupRSVP />);
    </script>
</body>
</html>
